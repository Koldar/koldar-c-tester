<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>KoldarCtester: Koldar C Tester: a simple C tester</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">KoldarCtester
   &#160;<span id="projectnumber">1.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('index.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Koldar C Tester: a simple C tester </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="section01"></a>
Introduction</h2>
<p>The KoldarCTester is a single header that can be used to quickly implement a test case for C code. C++ pure code is not supported though.</p>
<h2><a class="anchor" id="section02"></a>
To All People who want to setup it quickly</h2>
<p>If you're in a hurry and want to setup KoldarCTester now, here the basic example to make it work:</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">        #include &quot;<a class="code" href="KoldarCTester_8h.html">KoldarCTester.h</a>&quot;</span>

        <span class="comment">//All test function must have no formal parameters and void as return type</span>
        <span class="keywordtype">void</span> testSomething(){
                <span class="comment">//code something here</span>
                <span class="keywordflow">if</span> (a!=5){
                        failMsg(<span class="stringliteral">&quot;a is not 5!\n&quot;</span>);
                }
        }

        <span class="keywordtype">void</span> testSomethingElse(){
                <span class="comment">//code something here</span>
                <span class="keywordflow">if</span> (a&gt;4){
                        fail();
                }
        }

        <span class="keywordtype">int</span> main(){
                <a class="code" href="KoldarCTester_8h.html#a5e05020cd2cbf6ef54e4abb4c5d3ca57" title="adds a new function in the test list">kct_addTest</a>(testSomething);
                <a class="code" href="KoldarCTester_8h.html#a5e05020cd2cbf6ef54e4abb4c5d3ca57" title="adds a new function in the test list">kct_addTest</a>(testSomethingElse);

                kct_runAllTest(stdout);
        }
</pre></div><h2><a class="anchor" id="section03"></a>
How to use KoldarCTester</h2>
<p>Now that all the guys in a hurry are satisfied we can discuss how to correctly use this header. To use it you have to copy "KoldarCTester.h" within your header paths. After that you can create a new .c files that will be used as a single test suite: if you want more test suites, you'll have to create more .c files. A single test file .c is divided into 2 parts:</p>
<ol type="1">
<li>some test functions;</li>
<li>a main function;</li>
</ol>
<p>Basically KoldarCTester is a function list manager: you create some function and then you use some header function to add them in a list. After that you can execute them all in one command: the header handles all the work for you. So, first of all, you can create a new file (call it TestInteger.c for example) and include the header:</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">                #include &quot;<a class="code" href="KoldarCTester_8h.html">KoldarCTester.h</a>&quot;</span>
</pre></div><p>You have to be sure the header is inside in your "include paths" (maybe through the -I compiler directive). Secondly you have to create some test functions. For example, I have created these:</p>
<div class="fragment"><pre class="fragment">                <span class="comment">//Create 100 random number between 0 and 9 and test whether or</span>
                <span class="comment">//not the upper and lower bound are not violated.</span>
                <span class="keywordtype">void</span> testRandomX(){
                        <span class="keywordtype">int</span> i;
                        <span class="keywordtype">int</span> n;
                        <span class="keywordflow">for</span> (i=0;i&lt;100;i++){
                                n=rand()%10;
                                <a class="code" href="KoldarCTester_8h.html#a0871daf80ad3af568bac7e0502c17205" title="checks if a value is in a given interval">kct_assertExtremis</a>(0,9,<span class="keyword">true</span>,<span class="keyword">true</span>,rand()%10);
                        }
                }

                <span class="comment">//Test if the power of 2 is greater than 0</span>
                <span class="keywordtype">void</span> testPower(){
                        <span class="keywordtype">int</span> i;
                        <span class="keywordtype">int</span> num;
                        <span class="keywordflow">for</span> (i=0;i&lt;100;i++){
                                num=rand()%100;
                                <a class="code" href="KoldarCTester_8h.html#ab47b71b14664ccf62a03056bf6afd299" title="end the test as a failure if the condition is not met">kct_assertCondition</a>(num*num&gt;=0);
                        }
                }
</pre></div><p>Let's skip up for the moment the "kct_assertExtremis" and "kct_assertCondition" part. Now you have created all the test you need to verify some feature of your program. Now you need to run these tests... how? The main function does exactly that:</p>
<div class="fragment"><pre class="fragment">                <span class="keywordtype">int</span> main(){
                        <span class="comment">//add tests in the function list</span>
                        <a class="code" href="KoldarCTester_8h.html#a5e05020cd2cbf6ef54e4abb4c5d3ca57" title="adds a new function in the test list">kct_addTest</a>(testRandomX);
                        <a class="code" href="KoldarCTester_8h.html#a5e05020cd2cbf6ef54e4abb4c5d3ca57" title="adds a new function in the test list">kct_addTest</a>(testPower);
                        <span class="comment">//run the tests</span>
                        kct_runAllTest(stdout);
                }
</pre></div><p>Now you can build it. The compiler will probably complaints about "addTest" and "kct_runAllTest" do nothings: don't trust him, these function are actually pretty useful! Now try to run the program: you should get something like this:</p>
<div class="image">
<img src="image01.png" alt="image01.png"/>
</div>
<p>The tests are stored in a list: though it might be not so fast (like Bjame Stroudtrup say in <a href="http://www.youtube.com/watch?v=YQs6IC-vgmo">http://www.youtube.com/watch?v=YQs6IC-vgmo</a>), the list are quite easy to understand even for programmers beginner, so everyone can improve freely the header. Moreover, unlike other test suite, this header is totally <b>free of memory leak</b>. Sure, you can say: "well, that's should be obvious!"; well, of course it is, but you'll never know what you download out in the internet.</p>
<h2><a class="anchor" id="section04"></a>
Basic Elements in the header</h2>
<p>In the header there are basically 6 important elements:</p>
<ol type="1">
<li>assertions;</li>
<li>function <a class="el" href="KoldarCTester_8h.html#a5e05020cd2cbf6ef54e4abb4c5d3ca57" title="adds a new function in the test list">kct_addTest()</a>;</li>
<li>function <a class="el" href="KoldarCTester_8h.html#a8b21af1302fae84b59f07b2b8964a64e" title="adds a new function in the test list">kct_addTestImproved()</a>;</li>
<li>function kct_runAllTest();</li>
<li>variable currentTest;</li>
<li>variable testList;</li>
</ol>
<p>"testList" variable represents the list that will store the functions and some other data.</p>
<p>"currentTest" is the test that is running at the moment; it is mainly used to lighten the prototype of the function: in this way the developer can <b>focus</b> on the test development insted of wasting time on understand the testing suite.</p>
<p><a class="el" href="KoldarCTester_8h.html#a5e05020cd2cbf6ef54e4abb4c5d3ca57" title="adds a new function in the test list">kct_addTest()</a> is the main function used to add a function in the list.</p>
<p><a class="el" href="KoldarCTester_8h.html#a8b21af1302fae84b59f07b2b8964a64e" title="adds a new function in the test list">kct_addTestImproved()</a> has the same aim of <a class="el" href="KoldarCTester_8h.html#a5e05020cd2cbf6ef54e4abb4c5d3ca57" title="adds a new function in the test list">kct_addTest()</a> but with this function you can also specify whether or not you want to skip the function.</p>
<p>kct_runAllTest() is obviously used to execute the test. Note that with this function the list is automatically deallocated from the heap: in this way, if you are testing memory leak in your code, Koldar C Tester will not produces memory leaks by itself.</p>
<h2><a class="anchor" id="section05"></a>
Assertion</h2>
<p>As we have introduce in the previous section, one of the most important things in the header are assertions. Assertions are shortcuts to test some conditions: if the condition is met nothing happens; otherwise the test is terminate and the header alerts you that in the specific test something went wrong.</p>
<p>For example, let assume you want to determinate if a pointer to a FILE returned by fopen is NULL or not. Normally you do something like this:</p>
<div class="fragment"><pre class="fragment">                FILE* f=fopen(<span class="stringliteral">&quot;../test/fileToParse.txt&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);
                <span class="keywordflow">if</span> (f==NULL){
                        fprintf(stderr,<span class="stringliteral">&quot;Cannot open the file!\n&quot;</span>);
                        <span class="keywordflow">return</span>;
                }
</pre></div><p>This works, but if you have lots of these small control your code readability can substantly decrease. Assert helps you in that:</p>
<div class="fragment"><pre class="fragment">                FILE* f=fopen(<span class="stringliteral">&quot;../test/fileToParse.txt&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);
                kct_assertNotNullMsg(<span class="stringliteral">&quot;cannot open the file!\n&quot;</span>,f);
</pre></div><p>Smaller and more readable, right? Koldar C Tester let you use a lot of these assertions: you can read about all of them in the documentation! Generally speaking, however, assertion are divided into 2 strains:</p>
<ul>
<li><b>pure assertions</b> check only a particular condition;</li>
<li><b>message assertion</b> check a particular condition and if it is not met they warn you with an error message</li>
</ul>
<h2><a class="anchor" id="section06"></a>
Skip tests</h2>
<p>Let assume you have 100 tests regarding a particular big feature of your program. It is probable that, to execute all 100 tests, your computer needs some time. If you are sure that some tests (i.e 53 and 67) return a OK status, you might want to skip them, for not wasting time. Well, you can easily do that using <a class="el" href="KoldarCTester_8h.html#a8b21af1302fae84b59f07b2b8964a64e" title="adds a new function in the test list">kct_addTestImproved(someTest,false)</a>:</p>
<div class="fragment"><pre class="fragment">                <a class="code" href="KoldarCTester_8h.html#a8b21af1302fae84b59f07b2b8964a64e" title="adds a new function in the test list">kct_addTestImproved</a>(test51,<span class="keyword">true</span>);
                <a class="code" href="KoldarCTester_8h.html#a8b21af1302fae84b59f07b2b8964a64e" title="adds a new function in the test list">kct_addTestImproved</a>(test52,<span class="keyword">true</span>);
                <a class="code" href="KoldarCTester_8h.html#a8b21af1302fae84b59f07b2b8964a64e" title="adds a new function in the test list">kct_addTestImproved</a>(test53,<span class="keyword">false</span>);
                <a class="code" href="KoldarCTester_8h.html#a8b21af1302fae84b59f07b2b8964a64e" title="adds a new function in the test list">kct_addTestImproved</a>(test54,<span class="keyword">true</span>);
                <a class="code" href="KoldarCTester_8h.html#a8b21af1302fae84b59f07b2b8964a64e" title="adds a new function in the test list">kct_addTestImproved</a>(test55,<span class="keyword">true</span>);
</pre></div><p>While the first parameter is again the test function the second parameter indicates whether or not the computer should actually run the test: when you want to reexecute the function you can change "false" to "true".</p>
<p>Sure, you can just comment out the particular "kct_addTest(test53);" line, but the header let you also handle the skip in this way.</p>
<p>Some notes about how skipping tests influence the result outcomes:</p>
<ol type="1">
<li>the ratio successful tests/Number of tests does count the skipped tests;</li>
<li>the ratio failed tests/Number of tests does count the skipped tests;</li>
<li>the percentage of successful tests does not count skipped tests;</li>
<li>the percentage of failed tests does not count skipped tests;</li>
</ol>
<p>This means that the percentage of successful tests <b>must always be 100%</b>: if it isn't, then some tests aren't working. On the other hand the percentage of failed tests <b>must always be 0%</b>.</p>
<h2><a class="anchor" id="section07"></a>
"Deeper understanding of KoldarCTester.h"</h2>
<p>As we have said before, KoldarCTester basically creates a test list and loop over it.</p>
<div align="center">
<img src="dot_inline_dotgraph_1.png" alt="dot_inline_dotgraph_1.png" border="0" usemap="#dot_inline_dotgraph_1.map"/>
<map name="dot_inline_dotgraph_1.map" id="dot_inline_dotgraph_1.map"></map>
</div>
<p>Firstly the list (which in the header has type <a class="el" href="structTestList.html" title="Represents the entire list of test functions.">TestList</a>) is NULL. When someone use the function <a class="el" href="KoldarCTester_8h.html#a5e05020cd2cbf6ef54e4abb4c5d3ca57" title="adds a new function in the test list">kct_addTest()</a> or a similar function, the header automatically initialize the metadata of the list (stored in a <a class="el" href="structTestList.html" title="Represents the entire list of test functions.">TestList</a> structure). This struct has some metadata like: </p>
<ul>
<li>head (basilar if you want to loop over the list!); </li>
<li>tail (used to speed up the process of appending test at the tail of the list); </li>
<li>size;</li>
</ul>
<p>When someone use <a class="el" href="KoldarCTester_8h.html#a5e05020cd2cbf6ef54e4abb4c5d3ca57" title="adds a new function in the test list">kct_addTest()</a> (or a similar function) the header automatically initialize a new element of <a class="el" href="structTestListElement.html" title="Defines a single element of the list.">TestListElement</a> containing a pointer of the test functions (it also contains other small metadata). The newly created struct is then append at the tail of the list. Some of the metadata stored in a <a class="el" href="structTestListElement.html" title="Defines a single element of the list.">TestListElement</a> is: </p>
<ul>
<li>the test function; </li>
<li>result (the outcome of this test);</li>
</ul>
<p>The process continue over and over again until the main call kct_runAllTest(): when it happens, the program will loop through the TestListElements in the list (starting from the head one); for each of them the header will run the test function and will update some of the metadata, including the field result: this result will be important at the end of all tests, when the header has to generate statistics (like the number of test failures).</p>
<p>To allow such compact APIs, Koldar C Tester uses 2 variables: </p>
<ul>
<li>a default <a class="el" href="structTestList.html" title="Represents the entire list of test functions.">TestList</a> object which is used by every function in the header as default <a class="el" href="structTestList.html" title="Represents the entire list of test functions.">TestList</a>: in this way there's no need for the developer to manually create and initialize such list; </li>
<li>a variable currentTest: while the program iterate through out all the list element, every <a class="el" href="structTestListElement.html" title="Defines a single element of the list.">TestListElement</a> is stored in a temporary variable. In this way the program can exactly know what <a class="el" href="structTestListElement.html" title="Defines a single element of the list.">TestListElement</a> it is handling;</li>
</ul>
<h2><a class="anchor" id="section08"></a>
"Contacts"</h2>
<p>If you have suggestions or complains you can email me sending a mail to <a href="mailto:massimobono1@gmail.com">massimobono1@gmail.com</a>: i won't promise you that you'll receive a quick answer but I hope you understand!</p>
<dl class="date"><dt><b>Date:</b></dt><dd>Nov 27, 2013 </dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>koldar </dd></dl>
<dl class="version"><dt><b>Version:</b></dt><dd>1.0 </dd></dl>
</div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>

    <li class="footer">Generated on Fri Feb 28 2014 23:39:02 for KoldarCtester by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
